:root {
    --color-darkest: #0f380f;
    --color-dark: #306230;
    --color-light: #8bac0f;
    --color-lightest: #9bbc0f;
}

html,
body {
    height: 100%;
    margin: 0;
    overflow: hidden;
    background: var(--color-darkest);
}

body {
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Press Start 2P', cursive;
    color: var(--color-lightest);
}

/* 
   GAME CONTAINER = THE SAFE GREEN ZONE (540x540 logical)
   This container is sized to fit perfectly between the ribbons.
   It represents the "Green Area" that must be fully visible and clickable.
*/
#game-container {
    position: relative;
    /* Fit within width, and within height minus ribbons (120px) */
    width: min(100vw, calc(100vh - 120px));
    height: min(100vw, calc(100vh - 120px));
    /* Ensure it stays square */
    aspect-ratio: 1 / 1;

    /* Centered visually (flex body handles this, but margin auto is safe) */
    margin: auto;

    /* Border/Shadow for retro feel */
    border: 4px solid var(--color-lightest);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);

    /* Ensure canvas doesn't overflow this container visually? 
       NO, we want the dead zones to overflow if needed, but be covered by ribbons.
       But ribbons are fixed to body.
       So we allow overflow, but z-index handles hiding.
    */
    overflow: visible;
}

/* 
   GAME CANVAS = THE FULL 600x600 LOGICAL BUFFER
   It is larger than the container (111.11%).
   It is positioned so the Green Area (30,60 to 570,600) aligns with the Container.
*/
#game-canvas {
    display: block;
    position: absolute;

    /* Scale: 600 / 540 = 111.111% */
    width: 111.1111%;
    height: 111.1111%;

    /* Offset: 
       Left: -30 / 540 = -5.5555%
       Top: -60 / 540 = -11.1111%
    */
    left: -5.5555%;
    top: -11.1111%;

    background-color: var(--color-light);
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    touch-action: none;

    /* Ensure it is behind ribbons */
    z-index: 1;
}

/* Scanline overlay - covers the container */
#game-container::after {
    content: " ";
    display: block;
    position: absolute;
    inset: 0;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
    background-size: 100% 4px;
    z-index: 10;
    pointer-events: none;
}

/* 
   RIBBONS = FIXED UI LAYERS
   They sit on top of everything (z-index 20).
   They cover the "Dead Zones" of the canvas if they overflow the container.
*/
#top-ribbon,
#bottom-ribbon {
    position: fixed;
    /* Fixed to viewport */
    left: 0;
    right: 0;
    height: 60px;
    background: var(--color-darkest);
    color: var(--color-lightest);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    box-sizing: border-box;
    z-index: 20;
    /* Above canvas */
    font-size: 18px;
    text-shadow: 3px 3px 0px var(--color-dark);
    box-shadow: 0 4px 0 var(--color-dark);
    user-select: none;
    touch-action: manipulation;
}

#top-ribbon {
    top: 0;
}

#bottom-ribbon {
    bottom: 0;
}

/* Buttons inside ribbons */
#top-ribbon button,
#bottom-ribbon button {
    background: var(--color-dark);
    color: var(--color-lightest);
    border: none;
    padding: 10px 16px;
    font: inherit;
    cursor: pointer;
    min-width: 56px;
    min-height: 56px;
    box-shadow: 4px 4px 0 var(--color-darkest);
    text-shadow: 3px 3px 0 var(--color-dark);
}

#top-ribbon button:active,
#bottom-ribbon button:active {
    transform: translate(2px, 2px);
    box-shadow: 2px 2px 0 var(--color-darkest);
}

#top-ribbon #title {
    font-size: 28px;
    letter-spacing: 2px;
}

#top-ribbon #stats span {
    margin-left: 20px;
    font-size: 18px;
}

/* Modal overlay */
#modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(15, 56, 15, 0.98);
    display: none;
    align-items: flex-end;
    justify-content: center;
    z-index: 30;
    font-size: 20px;
}

#modal-overlay.active {
    display: flex;
}

#modal-container {
    width: 100%;
    max-height: 92%;
    background: var(--color-darkest);
    border-top: 12px solid var(--color-lightest);
    padding: 30px 20px;
    box-sizing: border-box;
    transform: translateY(100%);
    transition: transform 0.38s cubic-bezier(0.22, 1, 0.36, 1);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

#modal-overlay.active #modal-container {
    transform: translateY(0);
}

.modal-close {
    position: absolute;
    top: 12px;
    right: 20px;
    background: var(--color-dark);
    color: var(--color-lightest);
    font-size: 40px;
    width: 64px;
    height: 64px;
    border: none;
    box-shadow: 4px 4px 0 var(--color-darkest);
    cursor: pointer;
}

.modal-close:active {
    transform: translate(2px, 2px);
    box-shadow: 2px 2px 0 var(--color-darkest);
}

#ui-layer {
    display: none;
}